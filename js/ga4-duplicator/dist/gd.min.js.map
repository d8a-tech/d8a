{
  "version": 3,
  "sources": ["../src/version.ts", "../src/ga4-duplicator.ts"],
  "sourcesContent": ["/**\n * Package version identifier.\n * This value is replaced at build time via esbuild define.\n */\ndeclare const __D8A_VERSION__: string;\n\nfunction devVersionUtc(): string {\n  const now = new Date();\n  const year = String(now.getUTCFullYear()).slice(-2);\n  const month = String(now.getUTCMonth() + 1).padStart(2, \"0\");\n  return `dev-${year}-${month}`;\n}\n\nexport const version: string =\n  typeof __D8A_VERSION__ !== \"undefined\" && __D8A_VERSION__ ? __D8A_VERSION__ : devVersionUtc();\n", "/**\n * GA4 Duplicator - Intercepts GA4 collect calls and sends duplicates to D8A.\n */\n\nimport { version } from \"./version\";\n\ninterface GA4Destination {\n  measurement_id: string;\n  server_container_url: string;\n  convert_to_get?: boolean;\n}\n\ninterface GA4DuplicatorOptions {\n  server_container_url?: string;\n  destinations?: GA4Destination[];\n  debug?: boolean;\n  convert_to_get?: boolean;\n}\n\n(window as any).createGA4Duplicator = function (options: GA4DuplicatorOptions) {\n  /**\n   * Shared logic and configuration for interceptors.\n   */\n  interface InterceptorContext {\n    debug: boolean;\n    isTargetUrl(url: string | null | undefined): boolean;\n    buildDuplicateUrl(url: string): string;\n    getConvertToGet(url: string): boolean;\n  }\n\n  /**\n   * Base interface for monkey-patching implementations.\n   */\n  interface NetworkInterceptor {\n    install(context: InterceptorContext): void;\n  }\n\n  class FetchInterceptor implements NetworkInterceptor {\n    install(ctx: InterceptorContext): void {\n      const originalFetch = window.fetch;\n      window.fetch = function (\n        this: any,\n        resource: RequestInfo | URL,\n        config?: RequestInit,\n      ): Promise<Response> {\n        const requestUrl =\n          typeof resource === \"string\"\n            ? resource\n            : resource instanceof URL\n              ? resource.toString()\n              : (resource as any).url;\n        const method = (config && config.method) || (resource as any).method || \"GET\";\n\n        if (ctx.isTargetUrl(requestUrl)) {\n          const upperMethod = (method || \"GET\").toUpperCase();\n\n          // If we need the body from a Request, clone BEFORE calling the original fetch\n          let prepareBodyPromise: Promise<any> = Promise.resolve(undefined);\n          if (upperMethod === \"POST\") {\n            if (config && Object.prototype.hasOwnProperty.call(config, \"body\")) {\n              prepareBodyPromise = Promise.resolve(config.body);\n            } else if (typeof Request !== \"undefined\" && resource instanceof Request) {\n              try {\n                const clonedReq = resource.clone();\n                prepareBodyPromise = clonedReq.blob().catch(() => undefined);\n              } catch {\n                prepareBodyPromise = Promise.resolve(undefined);\n              }\n            }\n          }\n\n          // First send original request to Google Analytics\n          const originalPromise = originalFetch.apply(this, arguments as any);\n\n          // Then send duplicate\n          const duplicateUrl = ctx.buildDuplicateUrl(requestUrl);\n          const convertToGet = ctx.getConvertToGet(requestUrl);\n\n          if (upperMethod === \"GET\") {\n            originalFetch(duplicateUrl, { method: \"GET\", keepalive: true }).catch((error) => {\n              if (ctx.debug) console.error(\"gtm interceptor: error duplicating GET fetch:\", error);\n            });\n          } else if (upperMethod === \"POST\") {\n            prepareBodyPromise.then((dupBody) => {\n              if (convertToGet) {\n                // Convert POST to GET: split body into lines and send each as a separate GET request\n                let bodyStr = \"\";\n                if (typeof dupBody === \"string\") {\n                  bodyStr = dupBody;\n                } else if (dupBody instanceof Blob) {\n                  // For blob, we can't easily convert synchronously, so fall back to POST\n                  originalFetch(duplicateUrl, { method: \"POST\", body: dupBody, keepalive: true }).catch(\n                    (error) => {\n                      if (ctx.debug)\n                        console.error(\"gtm interceptor: error duplicating POST fetch (convert_to_get with Blob):\", error);\n                    },\n                  );\n                  return;\n                }\n\n                const lines = bodyStr.split(\"\\n\");\n                let sentAny = false;\n                for (let i = 0; i < lines.length; i++) {\n                  const line = lines[i].trim();\n                  if (line) {\n                    const mergedUrl = ctx.buildDuplicateUrl(requestUrl);\n                    const urlWithMergedLine = mergeBodyLineWithUrl(mergedUrl, line);\n                    originalFetch(urlWithMergedLine, { method: \"GET\", keepalive: true }).catch((error) => {\n                      if (ctx.debug)\n                        console.error(\"gtm interceptor: error duplicating GET fetch (from convert_to_get):\", error);\n                    });\n                    sentAny = true;\n                  }\n                }\n\n                // If body is empty or all lines were empty, send one GET with just URL params\n                if (!sentAny) {\n                  originalFetch(duplicateUrl, { method: \"GET\", keepalive: true }).catch((error) => {\n                    if (ctx.debug)\n                      console.error(\"gtm interceptor: error duplicating GET fetch (empty body convert_to_get):\", error);\n                  });\n                }\n              } else {\n                // Original POST duplication\n                originalFetch(duplicateUrl, { method: \"POST\", body: dupBody, keepalive: true }).catch(\n                  (error) => {\n                    if (ctx.debug)\n                      console.error(\"gtm interceptor: error duplicating POST fetch:\", error);\n                  },\n                );\n              }\n            });\n          }\n\n          return originalPromise;\n        }\n\n        return originalFetch.apply(this, arguments as any);\n      };\n    }\n  }\n\n  class XhrInterceptor implements NetworkInterceptor {\n    install(ctx: InterceptorContext): void {\n      const originalXHROpen = XMLHttpRequest.prototype.open;\n      const originalXHRSend = XMLHttpRequest.prototype.send;\n\n      XMLHttpRequest.prototype.open = function (this: any, method: string, url: string | URL) {\n        this._requestMethod = method;\n        this._requestUrl = url;\n        return originalXHROpen.apply(this, arguments as any);\n      };\n\n      XMLHttpRequest.prototype.send = function (\n        this: any,\n        body?: Document | XMLHttpRequestBodyInit | null,\n      ) {\n        if (this._requestUrl && ctx.isTargetUrl(this._requestUrl)) {\n          // First send original request to Google Analytics\n          const originalResult = originalXHRSend.apply(this, arguments as any);\n\n          // Then send duplicate to our endpoint mimicking method and payload\n          try {\n            const method = (this._requestMethod || \"GET\").toUpperCase();\n            const duplicateUrl = ctx.buildDuplicateUrl(this._requestUrl);\n            const convertToGet = ctx.getConvertToGet(this._requestUrl);\n\n            if (method === \"GET\") {\n              fetch(duplicateUrl, { method: \"GET\", keepalive: true }).catch((error) => {\n                if (ctx.debug) console.error(\"gtm interceptor: error duplicating GET xhr:\", error);\n              });\n            } else if (method === \"POST\") {\n              if (convertToGet) {\n                // Convert POST to GET: split body into lines and send each as a separate GET request\n                let bodyStr = \"\";\n                if (typeof body === \"string\") {\n                  bodyStr = body;\n                } else if (body && typeof body === \"object\") {\n                  // Try to convert Document or other types to string\n                  try {\n                    bodyStr = String(body);\n                  } catch {\n                    bodyStr = \"\";\n                  }\n                }\n\n                const lines = bodyStr.split(\"\\n\");\n                let sentAny = false;\n                for (let i = 0; i < lines.length; i++) {\n                  const line = lines[i].trim();\n                  if (line) {\n                    const mergedUrl = ctx.buildDuplicateUrl(this._requestUrl);\n                    const urlWithMergedLine = mergeBodyLineWithUrl(mergedUrl, line);\n                    fetch(urlWithMergedLine, { method: \"GET\", keepalive: true }).catch((error) => {\n                      if (ctx.debug)\n                        console.error(\"gtm interceptor: error duplicating GET xhr (from convert_to_get):\", error);\n                    });\n                    sentAny = true;\n                  }\n                }\n\n                // If body is empty or all lines were empty, send one GET with just URL params\n                if (!sentAny) {\n                  fetch(duplicateUrl, { method: \"GET\", keepalive: true }).catch((error) => {\n                    if (ctx.debug)\n                      console.error(\"gtm interceptor: error duplicating GET xhr (empty body convert_to_get):\", error);\n                  });\n                }\n              } else {\n                // Original POST duplication\n                fetch(duplicateUrl, { method: \"POST\", body: body as any, keepalive: true }).catch(\n                  (error) => {\n                    if (ctx.debug)\n                      console.error(\"gtm interceptor: error duplicating POST xhr:\", error);\n                  },\n                );\n              }\n            }\n          } catch (dupErr) {\n            if (ctx.debug) console.error(\"gtm interceptor: xhr duplication failed:\", dupErr);\n          }\n          return originalResult;\n        }\n        return originalXHRSend.apply(this, arguments as any);\n      };\n    }\n  }\n\n  class BeaconInterceptor implements NetworkInterceptor {\n    install(ctx: InterceptorContext): void {\n      if (!navigator.sendBeacon) return;\n\n      const originalSendBeacon = navigator.sendBeacon;\n      navigator.sendBeacon = function (\n        this: any,\n        url: string | URL,\n        data?: BodyInit | null,\n      ): boolean {\n        if (ctx.isTargetUrl(url as string)) {\n          const originalResult = originalSendBeacon.apply(this, arguments as any);\n          try {\n            const duplicateUrl = ctx.buildDuplicateUrl(url as string);\n            const convertToGet = ctx.getConvertToGet(url as string);\n\n            if (convertToGet) {\n              // Convert sendBeacon POST to GET: split body into lines and send each as a separate GET request\n              let bodyStr = \"\";\n              if (typeof data === \"string\") {\n                bodyStr = data;\n              } else if (data && typeof data === \"object\") {\n                try {\n                  bodyStr = String(data);\n                } catch {\n                  bodyStr = \"\";\n                }\n              }\n\n              const lines = bodyStr.split(\"\\n\");\n              let sentAny = false;\n              for (let i = 0; i < lines.length; i++) {\n                const line = lines[i].trim();\n                if (line) {\n                  const mergedUrl = ctx.buildDuplicateUrl(url as string);\n                  const urlWithMergedLine = mergeBodyLineWithUrl(mergedUrl, line);\n                  fetch(urlWithMergedLine, { method: \"GET\", keepalive: true }).catch((error) => {\n                    if (ctx.debug)\n                      console.error(\"gtm interceptor: error duplicating GET beacon (from convert_to_get):\", error);\n                  });\n                  sentAny = true;\n                }\n              }\n\n              // If body is empty or all lines were empty, send one GET with just URL params\n              if (!sentAny) {\n                fetch(duplicateUrl, { method: \"GET\", keepalive: true }).catch((error) => {\n                  if (ctx.debug)\n                    console.error(\"gtm interceptor: error duplicating GET beacon (empty body convert_to_get):\", error);\n                });\n              }\n            } else {\n              // Original sendBeacon duplication\n              originalSendBeacon.call(navigator, duplicateUrl, data);\n            }\n          } catch (e) {\n            if (ctx.debug) console.error(\"gtm interceptor: error duplicating sendBeacon:\", e);\n          }\n          return originalResult;\n        }\n        return originalSendBeacon.apply(this, arguments as any);\n      };\n    }\n  }\n\n  class ScriptInterceptor implements NetworkInterceptor {\n    install(ctx: InterceptorContext): void {\n      try {\n        const scriptSrcDescriptor = Object.getOwnPropertyDescriptor(\n          HTMLScriptElement.prototype,\n          \"src\",\n        );\n        const originalScriptSrcSetter = scriptSrcDescriptor && scriptSrcDescriptor.set;\n        const originalScriptSrcGetter = scriptSrcDescriptor && scriptSrcDescriptor.get;\n        const originalScriptSetAttribute = HTMLScriptElement.prototype.setAttribute;\n\n        const duplicateIfGA4Url = (urlString: string) => {\n          try {\n            if (!ctx.isTargetUrl(urlString)) return;\n            fetch(ctx.buildDuplicateUrl(urlString), { method: \"GET\", keepalive: true }).catch(\n              (error) => {\n                if (ctx.debug)\n                  console.error(\"gtm interceptor: error duplicating script GET:\", error);\n              },\n            );\n          } catch {\n            // Intentionally empty\n          }\n        };\n\n        if (originalScriptSrcSetter && originalScriptSrcGetter) {\n          const setter = originalScriptSrcSetter;\n          const getter = originalScriptSrcGetter;\n          Object.defineProperty(HTMLScriptElement.prototype, \"src\", {\n            configurable: true,\n            enumerable: true,\n            get: function (this: any) {\n              return getter.call(this);\n            },\n            set: function (this: any, value: string) {\n              try {\n                const last = this.__ga4LastSrcDuplicated;\n                if (value && value !== last) {\n                  duplicateIfGA4Url(String(value));\n                  this.__ga4LastSrcDuplicated = String(value);\n                }\n                const self = this;\n                const onloadOnce = function () {\n                  try {\n                    const finalUrl = self.src;\n                    if (finalUrl && finalUrl !== self.__ga4LastSrcDuplicated) {\n                      duplicateIfGA4Url(finalUrl);\n                      self.__ga4LastSrcDuplicated = finalUrl;\n                    }\n                  } catch {}\n                  self.removeEventListener(\"load\", onloadOnce);\n                };\n                this.addEventListener(\"load\", onloadOnce);\n              } catch {}\n              setter.call(this, value);\n            },\n          });\n        }\n\n        HTMLScriptElement.prototype.setAttribute = function (\n          this: any,\n          name: string,\n          value: string,\n        ) {\n          try {\n            if (String(name).toLowerCase() === \"src\") {\n              const v = String(value);\n              const last = this.__ga4LastSrcDuplicated;\n              if (v && v !== last) {\n                duplicateIfGA4Url(v);\n                this.__ga4LastSrcDuplicated = v;\n              }\n              const selfAttr = this;\n              const onloadOnceAttr = function () {\n                try {\n                  const finalUrlAttr = selfAttr.src;\n                  if (finalUrlAttr && finalUrlAttr !== selfAttr.__ga4LastSrcDuplicated) {\n                    duplicateIfGA4Url(finalUrlAttr);\n                    selfAttr.__ga4LastSrcDuplicated = finalUrlAttr;\n                  }\n                } catch {}\n                selfAttr.removeEventListener(\"load\", onloadOnceAttr);\n              };\n              this.addEventListener(\"load\", onloadOnceAttr);\n            }\n          } catch {\n            // Intentionally empty\n          }\n          return originalScriptSetAttribute.apply(this, arguments as any);\n        };\n      } catch {}\n    }\n  }\n\n  if ((window as any).__ga4DuplicatorInitialized) {\n    if (options.debug) console.warn(\"GA4 Duplicator: already initialized.\");\n    return;\n  }\n\n  const destinations: GA4Destination[] = [];\n  if (options.destinations && Array.isArray(options.destinations)) {\n    for (let i = 0; i < options.destinations.length; i++) {\n      const dest = options.destinations[i];\n      destinations.push({\n        measurement_id: dest.measurement_id,\n        server_container_url: dest.server_container_url,\n        convert_to_get: dest.convert_to_get !== undefined ? dest.convert_to_get : options.convert_to_get,\n      });\n    }\n  }\n\n  if (options.server_container_url) {\n    destinations.push({\n      measurement_id: \"*\",\n      server_container_url: options.server_container_url,\n      convert_to_get: options.convert_to_get,\n    });\n  }\n\n  if (destinations.length === 0) {\n    console.error(\"GA4 Duplicator: either server_container_url or destinations array is required\");\n    return;\n  }\n\n  function normalizePath(p: string): string {\n    p = String(p || \"\");\n    p = p.replace(/\\/+$/, \"\");\n    return p === \"\" ? \"/\" : p;\n  }\n\n  function matchesId(pattern: string, id: string): boolean {\n    if (!pattern || pattern === \"*\") return true;\n    try {\n      const regexStr = pattern.replace(/[.+^${}()|[\\]\\\\]/g, \"\\\\$&\").replace(/\\*/g, \".*\");\n      return new RegExp(\"^\" + regexStr + \"$\", \"i\").test(id);\n    } catch {\n      return pattern.toLowerCase() === id.toLowerCase();\n    }\n  }\n\n  function getMeasurementId(url: string): string {\n    try {\n      const parsed = new URL(url, location.href);\n      return parsed.searchParams.get(\"tid\") || parsed.searchParams.get(\"id\") || \"\";\n    } catch {\n      const match = url.match(/[?&](?:tid|id)=([^&?#]+)/);\n      return match ? decodeURIComponent(match[1]) : \"\";\n    }\n  }\n\n  function getDestinationForId(id: string): GA4Destination | null {\n    for (let i = 0; i < destinations.length; i++) {\n      if (matchesId(destinations[i].measurement_id, id)) {\n        return destinations[i];\n      }\n    }\n    return null;\n  }\n\n  function mergeBodyLineWithUrl(originalUrl: string, bodyLine: string): string {\n    try {\n      const url = new URL(originalUrl, location.href);\n      const lineParams = new URLSearchParams(bodyLine);\n\n      // Line parameters override URL parameters\n      for (const [key] of lineParams.entries()) {\n        url.searchParams.delete(key);\n      }\n      for (const [key, value] of lineParams.entries()) {\n        url.searchParams.append(key, value);\n      }\n\n      return url.toString();\n    } catch {\n      // Fallback: if URL parsing fails, try string manipulation\n      const urlWithoutQuery = originalUrl.split(\"?\")[0];\n      const originalParams = originalUrl.match(/\\?(.*)/) ? originalUrl.match(/\\?(.*)/)![1] : \"\";\n      const merged = originalParams + (originalParams && bodyLine ? \"&\" : \"\") + bodyLine;\n      return urlWithoutQuery + (merged ? \"?\" + merged : \"\");\n    }\n  }\n\n  function getDuplicateEndpointUrl(dest: GA4Destination): URL {\n    const trackingURL = String(dest.server_container_url || \"\").trim();\n    const u = new URL(trackingURL, location.href);\n    u.search = \"\";\n    u.hash = \"\";\n    return u;\n  }\n\n  function isTargetUrl(url: string | null | undefined): boolean {\n    if (!url || typeof url !== \"string\") return false;\n    try {\n      const parsed = new URL(url, location.href);\n\n      for (let i = 0; i < destinations.length; i++) {\n        const duplicateTarget = getDuplicateEndpointUrl(destinations[i]);\n        if (\n          parsed.origin === duplicateTarget.origin &&\n          normalizePath(parsed.pathname) === normalizePath(duplicateTarget.pathname)\n        ) {\n          return false;\n        }\n      }\n\n      const params = parsed.searchParams;\n      const hasGtm = params.has(\"gtm\");\n      const hasTagExp = params.has(\"tag_exp\");\n      const measurementId = params.get(\"tid\") || params.get(\"id\") || \"\";\n      const isMeasurementIdGA4 = /^G-[A-Z0-9]+$/i.test(measurementId);\n\n      return hasGtm && hasTagExp && isMeasurementIdGA4;\n    } catch {\n      if (typeof url === \"string\") {\n        for (let j = 0; j < destinations.length; j++) {\n          try {\n            const target = getDuplicateEndpointUrl(destinations[j]);\n            const targetNoQuery = target.origin + target.pathname;\n            if (url.indexOf(targetNoQuery) !== -1) return false;\n          } catch {\n            // Intentionally empty\n          }\n        }\n\n        const hasGtmFallback = url.indexOf(\"gtm=\") !== -1;\n        const hasTagExpFallback = url.indexOf(\"tag_exp=\") !== -1;\n        const idMatch = url.match(/[?&](?:tid|id)=G-[A-Za-z0-9]+/);\n        return !!(hasGtmFallback && hasTagExpFallback && idMatch);\n      }\n      return false;\n    }\n  }\n\n  function buildDuplicateUrl(originalUrl: string): string {\n    const id = getMeasurementId(originalUrl);\n    const dest = getDestinationForId(id);\n    if (!dest) return \"\";\n\n    const dst = getDuplicateEndpointUrl(dest);\n    try {\n      const src = new URL(originalUrl, location.href);\n      dst.search = src.search;\n      dst.searchParams.set(\"_dtv\", version);\n      dst.searchParams.set(\"_dtn\", \"gd\");\n    } catch {}\n    return dst.toString();\n  }\n\n  function getConvertToGet(url: string): boolean {\n    const id = getMeasurementId(url);\n    const dest = getDestinationForId(id);\n    return dest ? !!dest.convert_to_get : false;\n  }\n\n  const context: InterceptorContext = {\n    debug: !!options.debug,\n    isTargetUrl,\n    buildDuplicateUrl,\n    getConvertToGet,\n  };\n\n  const interceptors: NetworkInterceptor[] = [\n    new FetchInterceptor(),\n    new XhrInterceptor(),\n    new BeaconInterceptor(),\n    new ScriptInterceptor(),\n  ];\n\n  for (let i = 0; i < interceptors.length; i++) {\n    try {\n      interceptors[i].install(context);\n    } catch (e) {\n      if (options.debug) console.error(\"GA4 Duplicator: failed to install interceptor\", e);\n    }\n  }\n\n  (window as any).__ga4DuplicatorInitialized = true;\n};\n"],
  "mappings": "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",
  "names": ["version", "options", "FetchInterceptor", "ctx", "originalFetch", "resource", "config", "requestUrl", "method", "upperMethod", "prepareBodyPromise", "e", "originalPromise", "duplicateUrl", "convertToGet", "error", "dupBody", "bodyStr", "lines", "sentAny", "i", "line", "mergedUrl", "urlWithMergedLine", "mergeBodyLineWithUrl", "XhrInterceptor", "originalXHROpen", "originalXHRSend", "url", "body", "originalResult", "dupErr", "BeaconInterceptor", "originalSendBeacon", "data", "ScriptInterceptor", "scriptSrcDescriptor", "originalScriptSrcSetter", "originalScriptSrcGetter", "originalScriptSetAttribute", "duplicateIfGA4Url", "urlString", "setter", "getter", "value", "last", "self", "onloadOnce", "finalUrl", "name", "v", "selfAttr", "onloadOnceAttr", "finalUrlAttr", "destinations", "dest", "normalizePath", "p", "matchesId", "pattern", "id", "regexStr", "getMeasurementId", "parsed", "match", "getDestinationForId", "originalUrl", "bodyLine", "lineParams", "key", "urlWithoutQuery", "originalParams", "merged", "getDuplicateEndpointUrl", "trackingURL", "u", "isTargetUrl", "duplicateTarget", "params", "hasGtm", "hasTagExp", "measurementId", "isMeasurementIdGA4", "j", "target", "targetNoQuery", "hasGtmFallback", "hasTagExpFallback", "idMatch", "buildDuplicateUrl", "dst", "src", "version", "getConvertToGet", "context", "interceptors"]
}
